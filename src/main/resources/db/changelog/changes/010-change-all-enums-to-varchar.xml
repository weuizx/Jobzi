<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.20.xsd">

    <changeSet id="010-change-all-enums-to-varchar" author="jobzi">
        <sqlFile path="sql/010-change-all-enums-to-varchar.sql"
                 relativeToChangelogFile="true"
                 encoding="UTF-8"
                 splitStatements="true"
                 stripComments="false"/>
        <rollback>
            CREATE TYPE business_role AS ENUM ('ADMIN', 'MANAGER');
            ALTER TABLE business_users ALTER COLUMN role TYPE business_role USING role::business_role;
            CREATE TYPE vacancy_status AS ENUM ('DRAFT', 'ACTIVE', 'PAUSED', 'CLOSED');
            ALTER TABLE vacancies ALTER COLUMN status TYPE vacancy_status USING status::vacancy_status;
            CREATE TYPE question_type AS ENUM ('TEXT', 'YES_NO', 'CHOICE', 'PHONE', 'DATE', 'NUMBER');
            ALTER TABLE questions ALTER COLUMN question_type TYPE question_type USING question_type::question_type;
            CREATE TYPE application_status AS ENUM ('NEW', 'VIEWED', 'CONTACTED', 'ACCEPTED', 'REJECTED');
            ALTER TABLE applications ALTER COLUMN status TYPE application_status USING status::application_status;
        </rollback>
    </changeSet>

</databaseChangeLog>