# Архитектура Telegram бота Jobzi

## Структура компонентов

```
┌─────────────────────────────────────────────────────────────────┐
│                        Telegram API                              │
└─────────────────────┬───────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────┐
│                         JobziBot                                 │
│  • Извлекает данные из Telegram Update                          │
│  • Создает IncomingMessage DTO                                  │
│  • Отправляет сообщения пользователям                           │
└─────────────────────┬───────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────┐
│                      MessageResolver                             │
│  • Определяет тип пользователя                                  │
│  • Маршрутизирует к соответствующему Handler                    │
└─────────┬───────────┬──────────────────┬────────────────────────┘
          │           │                  │
          │           │                  │
    ┌─────▼──────┐  ┌─▼──────────────┐  ┌▼─────────────────┐
    │  SuperAdmin│  │   Business      │  │   Applicant      │
    │   Handler  │  │   Handler       │  │   Handler        │
    └─────┬──────┘  └─┬──────────────┘  └┬─────────────────┘
          │           │                  │
          │           │                  │
    ┌─────▼──────┐  ┌─▼──────────────┐  ┌▼─────────────────┐
    │  SuperAdmin│  │   Business      │  │   Applicant      │
    │  Telegram  │  │   Telegram      │  │   Telegram       │
    │   Service  │  │   Service       │  │   Service        │
    └─────┬──────┘  └─┬──────────────┘  └┬─────────────────┘
          │           │                  │
          │           │                  │
          ▼           ▼                  ▼
┌─────────────────────────────────────────────────────────────────┐
│                      Business Services                           │
│  • SuperAdminService                                            │
│  • BusinessDbService                                            │
│  • UserDbService                                                │
│  • BusinessUserDbService                                        │
└─────────────────────┬───────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────┐
│                      Repositories & Database                     │
└─────────────────────────────────────────────────────────────────┘
```

## Типы пользователей

### 1. Суперадмин (SUPERADMIN)
- Создается вручную через БД
- Может создавать и управлять бизнесами
- Команды:
  - `/superadmin activate` - активировать бизнес
  - `/superadmin list` - список всех бизнесов
  - `/superadmin block` - заблокировать бизнес
  - `/superadmin unblock` - разблокировать бизнес

### 2. Представитель бизнеса
- Создается суперадмином
- Может управлять вакансиями своего бизнеса
- Функционал в разработке

### 3. Соискатель (по умолчанию)
- Любой новый пользователь
- Может откликаться на вакансии
- Функционал в разработке

## Компоненты

### DTO
- **IncomingMessage** - данные входящего сообщения от Telegram

### Resolver
- **MessageResolver** - определяет тип пользователя и вызывает нужный handler

### Handlers
- **SuperAdminHandler** - обработка команд суперадмина
- **BusinessHandler** - обработка команд представителя бизнеса
- **ApplicantHandler** - обработка команд соискателя

### Services
- **SuperAdminTelegramService** - бизнес-логика для суперадмина
- **BusinessTelegramService** - бизнес-логика для бизнеса (заглушка)
- **ApplicantTelegramService** - бизнес-логика для соискателей (заглушка)

### DB Services
- **UserDbService** - работа с пользователями, включая проверку `isBusinessRepresentative()`
- **SuperAdminService** - операции суперадмина (блокировка бизнесов и т.д.)
- **BusinessDbService** - работа с бизнесами
- **BusinessUserDbService** - работа со связью пользователь-бизнес