@startuml TO-BE_Activity_2_Auto_Processing
title Декомпозиция TO-BE: Автоматическая обработка откликов

|Соискатель|
start
:Увидеть объявление\nс кодом ABC123;
:Открыть Jobzi бота;
:Ввести код ABC123;

|Система|
:Валидировать формат\n[A-Z]{3}\\d{3};
if (Код корректен?) then (Нет)
  :Показать ошибку;
  stop
endif

:Найти вакансию\nв БД по коду;
if (Вакансия найдена\nи ACTIVE?) then (Нет)
  :Показать\n"Вакансия не найдена";
  stop
endif

:Проверить дубль отклика;
if (Уже откликался?) then (Да)
  :Показать\n"Вы уже откликались";
  stop
endif

:Показать информацию\nо вакансии;
:Показать кнопки\n[✅ Да] [❌ Нет];

|Соискатель|
:Нажать "✅ Да";

|Система|
:Создать Application\n(status=NEW);
:Загрузить вопросы\nанкеты;

repeat
  :Показать вопрос N/M\nс индикацией прогресса;

  |Соискатель|
  :Ввести ответ;

  |Система|
  if (Валидация OK?) then (Нет)
    :Показать ошибку;
  else (Да)
    :Сохранить Answer\nсо snapshot контекста;
    note right
      Snapshot включает:
      - question_text
      - question_type
      - question_order
    end note
  endif
repeat while (Есть еще\nвопросы?) is (Да)
->Нет;

:Показать "Отклик отправлен";

|Работодатель (Параллельно)|
:Получить уведомление\n"Новый отклик на ABC123";

|Система|
:Завершить процесс;

note right
  Время: 30 секунд - 1 минута
  Все данные собраны автоматически
  Структурированный формат
end note

stop

@enduml
